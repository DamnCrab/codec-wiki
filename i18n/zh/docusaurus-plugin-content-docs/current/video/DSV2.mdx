---
title: DSV2
sidebar_position: 17
---

# DSV2 数字子带视频编码标准二代

**DSV2**（全称Digital Subband Video 2）是一款采用小波变换与基于块的运动补偿技术的有损/无损视频编解码器。该标准针对CIF（352x288）至全高清（1920x1080）分辨率范围，在中低码率至中高码率场景下能实现最优性能。其压缩效率与画质表现与MPEG-4 Part 2及[AVC/H.264](./AVC.mdx)（仅使用P帧时）相当。2.8版本比特流格式已于2025年6月20日冻结。

DSV2是初代[DSV](./DSV.mdx)编解码器的升级版本。

## 核心技术特性

DSV2集成了多项现代编解码特性，专注于纯整数运算且避免使用第三方库：

- **压缩方法**：采用多分辨率子带分析（即小波变换）替代传统DCT变换
- **运动补偿**：支持1/4像素精度运动补偿，并具备"扩展预测范围模式"(EPRM)以提升预测精度
- **帧类型**：使用I帧与P帧构成可变长度封闭式图像组(GOP)，不支持B帧双向预测
- **色彩空间**：兼容4:1:0、4:1:1、4:2:0、4:2:2及4:4:4多种色度采样格式
- **画质优化**：集成自适应量化、环路滤波与心理视觉增强技术
- **无损编码**：提供无损压缩模式

## 编码器实现方案

项目仓库中的具体编码器实现包含以下高级特性：

- **码率控制**：支持单次平均码率(ABR)与恒定质量因子(CRF)模式
- **场景检测**：采用复杂场景切换检测算法
- **人眼视觉系统(HVS)**：基于HVS模型进行帧内块模式决策与自适应量化
- **运动估计**：实现分层式运动估计

## 技术限制

该编解码器存在开发者设定与技术层面的双重限制：

- 不支持隔行扫描视频
- 分量位深限制为8bit
- 帧宽高必须可被2整除
- 参考实现为单线程设计，未使用硬件加速、SIMD指令或浮点运算

## 使用指南

DSV2参考编解码器采用C89编写，可通过标准C编译器或Zig构建系统编译。这是目前唯一可用的DSV2编码器/解码器组合。[DSV2 GitHub仓库](https://github.com/LMP88959/Digital-Subband-Video-2)提供参考实现的构建说明与源代码。

### 编码器使用

使用`e`命令进行视频编码，示例指令如下：

```bash
./dsv2 e -inp=video.y4m -out=compressed.dsv -y4m=1 -qp=60 -gop=48
```

### 解码器使用

使用`d`命令解码DSV2文件，示例指令如下：

```bash
./dsv2 d -inp=video.dsv -out=decompressed.y4m -y4m=1 -out420p=1
```

## 小波变换技术

DSV2等基于小波的视频编解码器利用小波变换来减少数字视频的数据量。

与广泛使用的[离散余弦变换](../introduction/terminology.mdx#discrete-cosine-transform-dct)(DCT)相比，小波变换采用截然不同的方法论。DCT中每个系数代表应用于整个块的固定模式，而小波变换的每个系数代表作用于块局部区域的特定模式。

由于小波变换能利用图像中的大尺度冗余，通常用于整帧或大重叠区域分析。相比之下，DCT通常作用于小区域，旨在覆盖图案与复杂度相对均匀的区域（构成[AVC/H.264](./AVC.mdx)等现代块基编解码器的基础）

### 压缩流程解析

小波压缩的核心是通过多步骤将像素数据转换为更易压缩的格式，CineForm编解码器即为典型范例。

#### 小波变换过程

小波可视为分离低频数据（图像平滑区域）与高频数据（细节边缘）的一维滤波器。对二维图像需进行水平和垂直双向处理。

以CineForm采用的2-6小波为例，其低频分量计算为两像素之和：

`低频样本 = 像素[x] + 像素[x+1]`

高频分量则通过六个输入像素捕捉精细细节：

`高频样本 = 像素[x] - 像素[x+1] + (-像素[x-2] - 像素[x-1] + 像素[x+2] + 像素[x+3])/8`

该操作通常在图像低频象限重复执行三个层级，逐步将图像能量集中至更小区域，此即2-6小波的核心原理。

#### 量化处理

小波变换后对高频数据进行量化。人眼对高频区域的细微变化不敏感，通过将小波输出除以量化值可实现数据缩减：

`高频样本 = (小波输出) / 量化器`

后续通过熵编码进行[无损压缩](../introduction/lossless.mdx)。

### 优劣对比

相比H.264等采用的块基DCT方案，小波压缩呈现不同的特性平衡。

#### 优势

- 小波变换不受锐利块边界限制，避免了DCT编解码器在低码率下常见的块效应与振铃效应
- 如CineForm等小波编解码器效率随分辨率提升而增强，特别适合HD、4K及360°视频制作
- 可设计为快速解码低分辨率视频，显著提升剪辑工作流效率

#### 劣势

尽管具备理论优势，小波编解码器面临制约其普及的实际挑战：

- 缺乏高效的帧内预测机制。不同于H.264可基于相邻像素精确预测，小波的重叠特性导致帧内压缩效率较低
- 为避免运动补偿帧出现块效应，常采用重叠块运动补偿(OBMC)，对CPU资源需求远高于标准运动补偿
- 低码率下可能产生模糊效果，因小波无法像DCT编解码器有效保持视觉能量与锐利细节。这种模糊可能提升[PSNR](../metrics/PSNR.mdx)指标但降低主观观感，还可能引发视觉伪像
- 多数小波编解码器不具备空间自适应量化功能，导致细微纹理区域出现模糊