---
title: 色彩格式
sidebar_position: 2
---

# 色彩格式

为表示色彩值，需要约定一种格式。色彩格式由三要素构成：[色彩模型](#color-models)（包含[分量顺序](#component-order)和可能的[色度抽样](#chroma-subsampling)）、[位深度](#bit-depth)、以及[打包格式或平面格式](#packed-vs-planar)的选择。某些情况下还需考虑[字节序](#endianness)。

## 色彩模型

色彩模型是通过数据表示视频或图像中颜色的方法。不同模型以不同方式存储色彩和亮度信息。本节将重点介绍图像和视频领域最常用的模型。

### RGB模型

RGB是最广为人知的色彩模型，主要应用于图像编码。它由红（Red）、绿（Green）、蓝（Blue）三个通道组成，通过组合这三个通道决定每个像素的最终颜色。虽然显示器最终使用RGB模型显示图像（因为屏幕像素由红绿蓝LED构成），但视频编码通常不直接使用RGB，因为其他模型能提供更好的压缩效率。

### YUV模型

YUV（又称YCbCr）是视频编码中最常用的色彩模型。它包含三个分量：Y（亮度/Luma）表示明度，两个色度平面（Cb/Cr）表示色彩。尽管播放器需要将YUV转换为RGB才能渲染，但YUV在视频压缩方面相比RGB具有显著优势。

采用YCbCr最突出的优势是色度抽样优化——色度分量可以比亮度分量以更低分辨率编码，从而减小输出文件体积。详情参见[色度抽样章节](#chroma-subsampling)。

### 分量顺序

色彩模型中各分量的排列顺序通过字母序列表示。例如`RGB`表示红→绿→蓝，`BGR`则表示蓝→绿→红。

## 位深度

位深度指存储采样值所用的比特位数，主要有两种表示方式：

- **每分量位数**：如`RGB888`表示"RGB模型，红绿蓝各占8位"；`RGB565`表示"RGB模型，红5位/绿6位/蓝5位"
- **每采样总位数**：如`RGB24`表示"RGB模型，三个通道共占24位"。这种方式存在歧义，无法明确各分量具体位数分配。例如`RGB565`、`RGB556`和`RGB655`（尽管后两种不符合人眼对绿光敏感的特性）都会被标记为`RGB16`

## 打包格式 vs 平面格式

分量存储方式分为两种：

**打包格式（交错存储）**：
```
采样点:     1   2   3   4   5
数据:     RGB RGB RGB RGB RGB
```

**平面格式（分量分离）**：
```
采样点:   1 2 3 4 5
R通道:    R R R R R...
G通道:    G G G G G...
B通道:    B B B B B...
```

平面格式便于算法实现（可统一处理所有平面），而打包格式结构简单且常用于硬件加速[^vlc-wiki-yuv]。

## 字节序

不同计算机架构存储数字的方式不同（详见[字节序维基百科](//wikipedia.org/wiki/Endianness)）。主要分为两种：
- **小端序（x86架构）**：低位字节在前，记作`4321`
- **大端序（PowerPC架构）**：高位字节在前，记作`1234`

这对色彩格式很重要，例如`RGB565`可能存储为`12`或`21`，读取顺序错误会导致数据异常。VapourSynth不关心字节序，但FFmpeg需要特别注意。

## 色度抽样

Y'CbCr信号有三种常用色度抽样方案：
- **4:2:0**：色度分辨率在水平和垂直方向均减半
- **4:2:2**：水平分辨率减半，垂直分辨率不变
- **4:4:4**：完整色度分辨率（无抽样）

本指南主要关注4:2:0和4:4:4，因为4:2:2优势不明显。

4:2:0是视频最常用的格式（DVD、蓝光、摄像机录制等）。由于人眼通常不易察觉色度分辨率降低，在多数情况下使用4:4:4收益有限。但屏幕录制（文字/游戏UI等含精细色彩边缘的内容）推荐使用4:4:4，因为色度抽样会导致边缘锯齿化。

## 常见格式对照表

| VS格式名    | FFmpeg对应格式                                                                 | 说明                                                                                     |
| ----------- | --------------------------------------------------------------------------- | --------------------------------------------------------------------------------------- |
| `GRAY8`     | `gray8`                                                                     | 仅亮度，8位，打包格式                                                                     |
| `GRAY16`    | `gray16le`/`gray16be`（后缀表示[字节序](#endianness)）                          | 仅亮度，16位                                                                             |
| `RGB888`    | `rgb24`                                                                     | 红绿蓝各8位                                                                              |
| `YUV420P8`  | `yuv420p`                                                                   | 亮度+蓝色差+红色差，8位/分量，平面格式，4:2:0[抽样](#chroma-subsampling)                 |
| `YUV422P8`  | `yuv422p`                                                                   | 亮度+蓝色差+红色差，8位/分量，平面格式，4:2:2抽样                                         |
| `YUV444P8`  | `yuv444p`                                                                   | 亮度+蓝色差+红色差，8位/分量，平面格式，无抽样                                            |
| `YUV420P10` | `yuv420p10le`/`yuv420p10le`                                                 | 亮度+蓝色差+红色差，10位/分量，平面格式，4:2:0抽样                                        |
| `YUV422P10` | `yuv422p10le`/`yuv422p10le`                                                 | 亮度+蓝色差+红色差，10位/分量，平面格式，4:2:2抽样                                        |
| `YUV444P10` | `yuv444p10le`/`yuv444p10le`                                                 | 亮度+蓝色差+红色差，10位/分量，平面格式，无抽样                                           |

## 参考文献

[^vlc-wiki-yuv]: [YUV - VideoLAN维基](https://wiki.videolan.org/YUV/#Packed_formats)