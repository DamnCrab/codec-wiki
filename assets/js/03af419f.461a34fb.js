"use strict";(self.webpackChunkcodec_wiki=self.webpackChunkcodec_wiki||[]).push([[8600],{433:(e,n,t)=>{t.d(n,{Z:()=>s});t(7294);var i=t(6905);const a={tabItem:"tabItem_Ymn6"};var r=t(5893);function s(e){let{children:n,hidden:t,className:s}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,i.Z)(a.tabItem,s),hidden:t,children:n})}},2808:(e,n,t)=>{t.d(n,{Z:()=>y});var i=t(7294),a=t(6905),r=t(3735),s=t(6550),l=t(613),o=t(4423),c=t(636),d=t(9200);function u(e){return i.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,i.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:i,default:a}}=e;return{value:n,label:t,attributes:i,default:a}}))}(t);return function(e){const n=(0,c.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const a=(0,s.k6)(),r=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,o._X)(r),(0,i.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(a.location.search);n.set(r,e),a.replace({...a.location,search:n.toString()})}),[r,a])]}function b(e){const{defaultValue:n,queryString:t=!1,groupId:a}=e,r=h(e),[s,o]=(0,i.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const i=t.find((e=>e.default))??t[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:n,tabValues:r}))),[c,u]=m({queryString:t,groupId:a}),[b,f]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[a,r]=(0,d.Nk)(t);return[a,(0,i.useCallback)((e=>{t&&r.set(e)}),[t,r])]}({groupId:a}),g=(()=>{const e=c??b;return p({value:e,tabValues:r})?e:null})();(0,l.Z)((()=>{g&&o(g)}),[g]);return{selectedValue:s,selectValue:(0,i.useCallback)((e=>{if(!p({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),f(e)}),[u,f,r]),tabValues:r}}var f=t(5730);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=t(5893);function x(e){let{className:n,block:t,selectedValue:i,selectValue:s,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.o5)(),d=e=>{const n=e.currentTarget,t=o.indexOf(n),a=l[t].value;a!==i&&(c(n),s(a))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":t},n),children:l.map((e=>{let{value:n,label:t,attributes:r}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:i===n?0:-1,"aria-selected":i===n,ref:e=>o.push(e),onKeyDown:u,onClick:d,...r,className:(0,a.Z)("tabs__item",g.tabItem,r?.className,{"tabs__item--active":i===n}),children:t??n},n)}))})}function V(e){let{lazy:n,children:t,selectedValue:a}=e;const r=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=r.find((e=>e.props.value===a));return e?(0,i.cloneElement)(e,{className:"margin-top--md"}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:r.map(((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function j(e){const n=b(e);return(0,v.jsxs)("div",{className:(0,a.Z)("tabs-container",g.tabList),children:[(0,v.jsx)(x,{...e,...n}),(0,v.jsx)(V,{...e,...n})]})}function y(e){const n=(0,f.Z)();return(0,v.jsx)(j,{...e,children:u(e.children)},String(n))}},9255:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>c,toc:()=>u});var i=t(5893),a=t(1151),r=t(2808),s=t(433);const l={title:"VVenC",sidebar_position:9},o="VVenC",c={id:"encoders/VVenC",title:"VVenC",description:'<img src="https://autumn.revolt.chat/attachments/wU4lo6SU-hRjZSVeqd9vCOeAskthYXmiWHaXUTjyTa/VVenC_Spam.webp"',source:"@site/docs/encoders/VVenC.mdx",sourceDirName:"encoders",slug:"/encoders/VVenC",permalink:"/docs/encoders/VVenC",draft:!1,unlisted:!1,editUrl:"https://github.com/av1-community-contributors/codec-wiki/tree/main/docs/encoders/VVenC.mdx",tags:[],version:"current",sidebarPosition:9,frontMatter:{title:"VVenC",sidebar_position:9},sidebar:"tutorialSidebar",previous:{title:"SVT-VP9",permalink:"/docs/encoders/SVT-VP9"},next:{title:"uvg266",permalink:"/docs/encoders/uvg266"}},d={},u=[{value:"Installation",id:"installation",level:2},{value:"FFmpeg Integration",id:"ffmpeg-integration",level:3},{value:"Usage",id:"usage",level:2},{value:"Muxing",id:"muxing",level:2},{value:"VVdeC",id:"vvdec",level:2},{value:"Installation",id:"installation-1",level:3},{value:"Decoding",id:"decoding",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,a.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"vvenc",children:"VVenC"}),"\n",(0,i.jsxs)("picture",{children:[(0,i.jsx)("source",{srcset:"https://raw.githubusercontent.com/av1-community-contributors/images/main/VVenC_Spam.avif?token=GHSAT0AAAAAACEZPDXI3OYO3Z4Q7LU3Z52EZHY7FMA",type:"image/avif"}),(0,i.jsx)("img",{src:"https://autumn.revolt.chat/attachments/wU4lo6SU-hRjZSVeqd9vCOeAskthYXmiWHaXUTjyTa/VVenC_Spam.webp",alt:"vvencapp spamming the terminal output with progress per-picture-order-count cause god knows why",width:"XX",height:"YY",loading:"lazy"})]}),"\n",(0,i.jsxs)(n.p,{children:["VVenC is an open source command line application for encoding ",(0,i.jsx)(n.a,{href:"/docs/video/VVC",children:"H.266/VVC"})," written in C++ and developed by Fraunhofer Heinrich-Hertz-Institute (HHI)."]}),"\n",(0,i.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,i.jsxs)(r.Z,{children:[(0,i.jsxs)(s.Z,{value:"unixlike",label:"Linux & macOS",children:[(0,i.jsxs)(n.p,{children:["Arch Linux users may check the AUR for the ",(0,i.jsx)(n.code,{children:"vvenc"})," and ",(0,i.jsx)(n.code,{children:"vvenc-git"})," packages."]}),(0,i.jsx)(n.p,{children:"Compilation from source as shown belowe requires CMake."}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/fraunhoferhhi/vvenc.git\ncd vvenc\nmkdir build\ncd build\ncmake .. -DCMAKE_BUILD_TYPE=Release\ncmake --build .\n"})}),(0,i.jsxs)(n.p,{children:["Binaries will be available in ",(0,i.jsx)(n.code,{children:"bin/release-static/"})]}),(0,i.jsx)(n.h3,{id:"ffmpeg-integration",children:"FFmpeg Integration"}),(0,i.jsxs)(n.p,{children:["Although not officially supported, you can compile your own FFmpeg binary with ",(0,i.jsx)(n.code,{children:"libvvenc"})," and ",(0,i.jsx)(n.code,{children:"libvvdec"}),". A comprehensive tutorial can be found in the ",(0,i.jsx)(n.a,{href:"https://github.com/fraunhoferhhi/vvenc/wiki/FFmpeg-Integration",children:"official VVenC wiki"})," (",(0,i.jsx)(n.a,{href:"https://web.archive.org/web/20230509115800/https://github.com/fraunhoferhhi/vvenc/wiki/FFmpeg-Integration",children:"archive"}),")."]}),(0,i.jsxs)(n.p,{children:["The official guide is rather verbose, as FFmpeg (at the time of writing, 19 Feb 2024) does not support vvenc/vvdec officially. Below is an easy build script which uses an FFmpeg fork called FFmpeg-VVC. It is maintained by Marten Martin Eesmaa, who also maintains the ",(0,i.jsx)(n.a,{href:"https://github.com/MartinEesmaa/VVCEasy",children:"VVCEasy"})," GitHub repo featuring guides and more general information about working with VVC."]}),(0,i.jsxs)(n.p,{children:["Please be aware the script below produces a build of FFmpeg licensed under ",(0,i.jsx)(n.em,{children:"LGPL version 2.1 or later"}),". It is legal to distribute the resulting binary, given you do not interfere with the flags provided below."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Build FFmpeg with libvvdec, libvvenc, and fdk-aac"',children:'brew install libxml2 ffmpeg nasm # macOS-only; if on Linux, use your native package manager. Package names may differ.\ngit clone https://github.com/fraunhoferhhi/vvenc\ngit clone https://github.com/fraunhoferhhi/vvdec\ngit clone https://github.com/mstorsjo/fdk-aac\ncd vvenc && mkdir build && cd build\ncmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr/local ..\nsudo cmake --build . --target install -j $nproc\ncd ../../\ncd vvdec && mkdir build && cd build\ncmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr/local ..\nsudo cmake --build . --target install -j $nproc\ncd ../../\ncd fdk-aac && ./autogen.sh && ./configure\nmake -j\nsudo make install\ncd ../\ngit clone --depth=1 https://github.com/MartinEesmaa/FFmpeg-VVC\ncd FFmpeg-VVC\nexport PKG_CONFIG_PATH=/usr/local/lib/pkgconfig\n./configure --enable-libfdk-aac --enable-libvvenc --enable-libvvdec --enable-static --enable-pic --enable-libxml2 --pkg-config-flags="--static" --enable-sdl2\nmake -j\n'})}),(0,i.jsx)(n.p,{children:"Binaries will be available in the final directory you end up in after the build process is complete."})]}),(0,i.jsx)(s.Z,{value:"windows",label:"Windows",children:(0,i.jsxs)(n.p,{children:["To be filled. If you believe you can help, see our ",(0,i.jsx)(n.a,{href:"/docs/contribution-guide",children:"Contribution Guide"}),"."]})})]}),"\n",(0,i.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsxs)(n.p,{children:["There are two encoders, the simple encoder (",(0,i.jsx)(n.code,{children:"vvencapp"}),") and the full-featured expert mode encoder (",(0,i.jsx)(n.code,{children:"vvencFFapp"}),") which is based on the ",(0,i.jsx)(n.a,{href:"/docs/encoders/VTM",children:"VTM"})," configuration scheme. VVenC used to only accept YUV files input until support was added for Y4M."]}),"\n",(0,i.jsx)(n.p,{children:"YUV does not carry any of the original video's metadata, which means you'll have to manually input all the necessary parameters such as frame rates, resolution, bit depth, etc. Y4M takes care all of this automatically."}),"\n",(0,i.jsx)(n.p,{children:"Here are some examples:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Standard VVenC input"',children:"vvencapp -i input.y4m --qp 20 -o output.266\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Preset slow + qpa (already default) + YUV420P10"',children:"vvencapp -i input.y4m --preset slow --qpa on --qp 20 -c yuv420_10 -o output.266\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="Piping with FFmpeg"',children:"ffmpeg -hide_banner -loglevel error -i input.mkv -pix_fmt yuv420p10le -strict -1 -f yuv4mpegpipe - | vvencapp -i - --y4m --preset medium --qpa on --qp 20 -c yuv420_10 -o output.266\n"})}),"\n",(0,i.jsx)(n.admonition,{title:"Limitations",type:"warning",children:(0,i.jsx)(n.p,{children:"VVenC currently does not support input resolutions below 540p. In addition, VVenC usually produces bitstreams that don't decode correctly when using FFmpeg's recently implemented native ffvvc decoder (this is true as of the time of writing on 19 Feb 2024). For proper decoding, build FFmpeg with libvvdec."})}),"\n",(0,i.jsx)(n.admonition,{title:"QPA",type:"info",children:(0,i.jsxs)(n.p,{children:['VVenC by default operates with QP (Quantization Parameter), which is basically fixed quality. For "CRF-like" rate control, QPA is enabled by default\nQPA (provided by --qpa) enables perceptually motivated QP adaptation based on ',(0,i.jsx)(n.a,{href:"/docs/metrics/XPSNR",children:"XPSNR"}),". QPA modifies the QP value on the fly spatially and temporally as well as enabling temporal RDO."]})}),"\n",(0,i.jsx)(n.h2,{id:"muxing",children:"Muxing"}),"\n",(0,i.jsxs)(n.p,{children:["Since VVenC only outputs raw ",(0,i.jsx)(n.code,{children:".266"})," bitstream files, you can't just shove audio and subtitle streams in there. Instead you can remux them using ",(0,i.jsx)(n.a,{href:"https://github.com/gpac/gpac",children:"GPAC MP4Box"})," ",(0,i.jsx)(n.strong,{children:"nightly/beta/git"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["You can find all pre-built binaries for Windows, MacOS, and Ubuntu (Linux) right ",(0,i.jsx)(n.a,{href:"https://gpac.wp.imt.fr/downloads/gpac-nightly-builds",children:"here"}),", Arch Linux users can find mp4box/GPAC in the AUR, and those who aren't listed here can find the build instructions ",(0,i.jsx)(n.a,{href:"https://github.com/gpac/gpac/wiki/Build-Introduction",children:"here"}),". It is recommended to do a minimal build since most of the time you don't really need the extra stuff."]}),"\n",(0,i.jsx)(n.h2,{id:"vvdec",children:"VVdeC"}),"\n",(0,i.jsx)(n.p,{children:"VVdeC is the software decoding implementation for decoding/playing VVC files developed by Fraunhofer HHI. All features of the VVC Main10 features are supported. Currently (as of 19 Feb 2024), VVdeC is both more feature rich and much faster than FFmpeg's ffvvc decoder, though it is nearly infeasible for any VVC decoder implementation to be faster/more efficient than the highly optimized dav1d AV1 decoder."}),"\n",(0,i.jsx)(n.h3,{id:"installation-1",children:"Installation"}),"\n",(0,i.jsxs)(r.Z,{children:[(0,i.jsxs)(s.Z,{value:"unixlike",label:"Linux & macOS",children:[(0,i.jsxs)(n.p,{children:["Arch Linux users may check the AUR for the ",(0,i.jsx)(n.code,{children:"vvdec"})," and ",(0,i.jsx)(n.code,{children:"vvdec-git"})," packages."]}),(0,i.jsx)(n.p,{children:"Compilation from source as shown belowe requires CMake."}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/fraunhoferhhi/vvdec.git\ncd vvdec\nmkdir build\ncd build\ncmake .. -DCMAKE_BUILD_TYPE=Release\ncmake --build .\n"})}),(0,i.jsxs)(n.p,{children:["Binaries will be available in ",(0,i.jsx)(n.code,{children:"bin/release-static/"})]}),(0,i.jsx)(n.p,{children:"For FFmpeg integration, see the installation section for VVenC earlier in this entry."})]}),(0,i.jsx)(s.Z,{value:"windows",label:"Windows",children:(0,i.jsxs)(n.p,{children:["To be filled. If you believe you can help, see our ",(0,i.jsx)(n.a,{href:"/docs/contribution-guide",children:"Contribution Guide"}),"."]})})]}),"\n",(0,i.jsx)(n.h2,{id:"decoding",children:"Decoding"}),"\n",(0,i.jsxs)(n.p,{children:["There are several ways to decode VVC. Some are made simple by the ",(0,i.jsx)(n.a,{href:"https://github.com/MartinEesmaa/VVCEasy",children:"VVCEasy project"})," by Martin Eesmaa. If you have a newer version of FFmpeg since ffvvc was implemented, or you've built FFmpeg with libvvdec as shown above, it is as simple as running ",(0,i.jsx)(n.code,{children:"ffplay"})," assuming the right FFplay binary is in your PATH:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="FFplay VVC video"',children:"ffplay input.mp4\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Extending this to MPV, if you've built MPV from source using a VVC MPV build script (",(0,i.jsx)(n.a,{href:"https://github.com/gianni-rosato/mpv-build-vvc/",children:"1"}),") (",(0,i.jsx)(n.a,{href:"https://github.com/MartinEesmaa/mpv-build",children:"2"}),"), it is also a one-command solution assuming the right MPV binary is in your PATH:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="VVC video playing through MPV"',children:"mpv input.mp4\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The more manual process to play back VVC video is to pipe into several programs; ",(0,i.jsx)(n.a,{href:"/docs/utilities/mp4box",children:"MP4Box"})," beta/nightly/git, VVdeC, and a video player of choice summonable via CLI (MPV, VLC, ffplay) are required."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="MP4Box -> VVdeC --\x3e FFmpeg (without libvvdec support)"',children:"mp4box input.mp4 -raw vvc1:output=temp.266 && vvdecapp -v 0 -b temp.266 -o - | ffmpeg -video_size 1920x804 -framerate 24 -pixel_format yuv420p10le -f rawvideo -i - -i input.mp4 -c copy -map 0:v -map 1:a -f nut - | mpv -\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Adjust the ",(0,i.jsx)(n.strong,{children:"double"})," ",(0,i.jsx)(n.code,{children:"input.mp4"}),", ",(0,i.jsx)(n.code,{children:"-video_size"})," for resolution, ",(0,i.jsx)(n.code,{children:"-framerate"}),", ",(0,i.jsx)(n.code,{children:"-pixel_format"}),", and ",(0,i.jsx)(n.code,{children:"mpv"})," (Video player) accordingly, if not then your video will just play garbled glitches."]}),"\n",(0,i.jsx)(n.admonition,{title:"Temp File",type:"info",children:(0,i.jsxs)(n.p,{children:["You might see a new file appearing called ",(0,i.jsx)(n.code,{children:"temp.266"})," upon running the command. This is completely normal as ",(0,i.jsx)(n.code,{children:"mp4box"})," needs to output the raw bitstream so ",(0,i.jsx)(n.code,{children:"vvdec"})," will be able to decode it properly."]})})]})}function p(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>l,a:()=>s});var i=t(7294);const a={},r=i.createContext(a);function s(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);