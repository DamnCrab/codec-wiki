"use strict";(self.webpackChunkav_1_wiki=self.webpackChunkav_1_wiki||[]).push([[7363],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>k});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(a),m=r,k=c["".concat(s,".").concat(m)]||c[m]||d[m]||i;return a?n.createElement(k,o(o({ref:t},u),{},{components:a})):n.createElement(k,o({ref:t},u))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},1010:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var n=a(7462),r=(a(7294),a(3905));const i={label:"Av1an",order:200,templating:!0},o="Av1an",l={unversionedId:"utilities/av1an",id:"utilities/av1an",title:"Av1an",description:"Av1an encoding AV1 with 96 workers",source:"@site/docs/utilities/av1an.md",sourceDirName:"utilities",slug:"/utilities/av1an",permalink:"/av1-wiki.github.io/docs/utilities/av1an",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/utilities/av1an.md",tags:[],version:"current",frontMatter:{label:"Av1an",order:200,templating:!0},sidebar:"tutorialSidebar",previous:{title:"YUView",permalink:"/av1-wiki.github.io/docs/utilities/YUView"},next:{title:"dovi_tool",permalink:"/av1-wiki.github.io/docs/utilities/dovi_tool"}},s={},p=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Installation",id:"installation",level:2},{value:"Microsoft Windows",id:"microsoft-windows",level:3},{value:"MacOS",id:"macos",level:3},{value:"Linux",id:"linux",level:3},{value:"Docker",id:"docker",level:3}],u={toc:p},c="wrapper";function d(e){let{components:t,...a}=e;return(0,r.kt)(c,(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"av1an"},"Av1an"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://cdn.discordapp.com/attachments/756076013372440656/1103284312675188777/av1an_96_workers.jpeg",alt:"Av1an encoding AV1 with 96 workers"})),(0,r.kt)("p",null,"Av1an is a video encoding framework. It can increase your encoding speed and improve cpu utilization by running multiple encoder processes in parallel. Target quality, VMAF plotting, and more, available to take advantage for video encoding."),(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("p",null,"Since Av1an is just a tool that helps with parallelization, you'll need to have the following installed for the entire thing to work: "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Rust"),(0,r.kt)("li",{parentName:"ul"},"Python (Required for Vapoursynth, currently needs 3.11, this will change in the future so consult from ",(0,r.kt)("a",{parentName:"li",href:"http://www.vapoursynth.com/doc/installation.html"},"their website"),")"),(0,r.kt)("li",{parentName:"ul"},"FFmpeg"),(0,r.kt)("li",{parentName:"ul"},"MKVToolNix (mkvmerge)"),(0,r.kt)("li",{parentName:"ul"},"Vapoursynth"),(0,r.kt)("li",{parentName:"ul"},"L-SMASH (Vapoursynth plugin)"),(0,r.kt)("li",{parentName:"ul"},"FFMS2 (Vapoursynth plugin, optional)"),(0,r.kt)("li",{parentName:"ul"},"VMAF (For target VMAF, optional)"),(0,r.kt)("li",{parentName:"ul"},"Any of the supported encoders (aomenc, rav1e, SVT-AV1, vpxenc, x264, x265)")),(0,r.kt)("h2",{id:"installation"},"Installation"),(0,r.kt)("h3",{id:"microsoft-windows"},"Microsoft Windows"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"GUI:")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Install ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/n00mkrad/nmkoder"},"Nmkoder")," which is a GUI front-end to av1an with all dependencies installed"),(0,r.kt)("li",{parentName:"ol"},"You're done!")),(0,r.kt)("admonition",{title:"Outdated Software",type:"danger"},(0,r.kt)("p",{parentName:"admonition"},"Since Nmkoder already ships everything by default and it's last release was 29th March 2022. You need to manually update EVERYTHING (",(0,r.kt)("inlineCode",{parentName:"p"},"av1an.exe"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"aomenc.exe"),", etc) to get performance optimizations, better speeds, and more settings. Missing out on updates will result in your encodes being sub-optimal.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Pre-built binary, bleeding edge ","[Recommended]",":")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Download Av1an from ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/master-of-zen/Av1an/releases"},"here"),', select "Latest" and click the "Assets" dropdown. Put it in PATH')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Compiling, via cargo:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"cargo install av1an"))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Compiling ","[NOT recommended]",":")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/master-of-zen/Av1an.git\ncd Av1an\nset RUSTFLAGS=-C target-cpu=native\ncargo build --release\n")),(0,r.kt)("p",null,"You will run into errors with pkg-config ",(0,r.kt)("inlineCode",{parentName:"p"},"libavutil.pc")," being unavailable or whatnot, I am a total noob at software compilation and cannot help you with this as I am also stuck with it, which is why I am heavily against this method. If you know how to solve this contact me and I'll get this section updated."),(0,r.kt)("h3",{id:"macos"},"MacOS"),(0,r.kt)("p",null,"Sorry, I don't use or have Mac. You're on your own."),(0,r.kt)("h3",{id:"linux"},"Linux"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"The Easy Way:")," "),(0,r.kt)("p",null,"Install ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/gianni-rosato/aviator"},"Aviator"),", it is currently only available as a ",(0,r.kt)("a",{parentName:"p",href:"https://beta.flathub.org/apps/net.natesales.Aviator"},"Flatpak"),"\nor\nInstall ",(0,r.kt)("a",{parentName:"p",href:"https://giannirosato.com/blog/post/aviator-1/"},"rAV1ator"),", basically same thing but av1an + rav1e\n",(0,r.kt)("strong",{parentName:"p"},"Keep in mind Aviator ships with SVT-AV1 and rAV1ator with rav1e instead of Aomenc/AOM-AV1."),"\n","\xa0","\xa0"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"The compiling route:")),(0,r.kt)("p",null,"Prerequisites: "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Vapoursynth"),(0,r.kt)("li",{parentName:"ul"},"FFmpeg"),(0,r.kt)("li",{parentName:"ul"},"MKVToolNix (mkvmerge)"),(0,r.kt)("li",{parentName:"ul"},"Git"),(0,r.kt)("li",{parentName:"ul"},"Perl"),(0,r.kt)("li",{parentName:"ul"},"Nasm"),(0,r.kt)("li",{parentName:"ul"},"Rust (Use rustup on Debian/Ubuntu, as the package manager version is horribly outdated)"),(0,r.kt)("li",{parentName:"ul"},"Highway (libhwy)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'git clone https://github.com/master-of-zen/Av1an.git\ncd Av1an\nRUSTFLAGS="-C target-cpu=native" cargo build --release\n')),(0,r.kt)("p",null,"after done, the binary will be located in ",(0,r.kt)("inlineCode",{parentName:"p"},"target/release"),", copy it to somewhere like ",(0,r.kt)("inlineCode",{parentName:"p"},"/usr/bin")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"/usr/local/bin")),(0,r.kt)("h3",{id:"docker"},"Docker"),(0,r.kt)("p",null,"The following examples assume the file you want to encode is in your current working directory."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Linux")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'docker run --privileged -v "$(pwd):/videos" --user $(id -u):$(id -g) -it --rm masterofzen/av1an:latest -i S01E01.mkv {options}\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Windows")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'docker run --privileged -v "${PWD}:/videos" -it --rm masterofzen/av1an:latest -i S01E01.mkv {options}\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"The image can also be manually built by running")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'docker build -t "av1an" .\n')),(0,r.kt)("p",null,"in the root directory of this repository. The dependencies will automatically be installed into the image, no manual installations necessary."),(0,r.kt)("p",null,"To specify a different directory to use you would replace $(pwd) with the directory"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'docker run --privileged -v "/c/Users/masterofzen/Videos":/videos --user $(id -u):$(id -g) -it --rm masterofzen/av1an:latest -i S01E01.mkv {options}\n')),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"--user")," flag is required on linux to avoid permission issues with the docker container not being able to write to the location, if you get permission issues ensure your user has access to the folder that you are using to encode."))}d.isMDXComponent=!0}}]);