"use strict";(self.webpackChunkcodec_wiki=self.webpackChunkcodec_wiki||[]).push([[5745],{2316:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>c,toc:()=>u});var r=t(4848),i=t(8453),s=t(1470),a=t(9365);const l={label:"Av1an",sidebar_position:2,templating:!0},o="Av1an",c={id:"utilities/av1an",title:"Av1an",description:"Av1an is a video encoding framework. It can increase your encoding speed and improve CPU utilization by running multiple encoder processes in parallel. Target quality, VMAF plotting, and more, available to take advantage for video encoding.",source:"@site/docs/utilities/av1an.mdx",sourceDirName:"utilities",slug:"/utilities/av1an",permalink:"/docs/utilities/av1an",draft:!1,unlisted:!1,editUrl:"https://github.com/av1-community-contributors/codec-wiki/tree/main/docs/utilities/av1an.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{label:"Av1an",sidebar_position:2,templating:!0},sidebar:"tutorialSidebar",previous:{title:"Aviator",permalink:"/docs/utilities/Aviator"},next:{title:"FFmpeg",permalink:"/docs/utilities/ffmpeg"}},d={},u=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Installation",id:"installation",level:2},{value:"Microsoft Windows",id:"microsoft-windows",level:3},{value:"MacOS",id:"macos",level:3},{value:"Linux",id:"linux",level:3},{value:"Docker",id:"docker",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"av1an",children:"Av1an"}),"\n",(0,r.jsxs)("picture",{children:[(0,r.jsx)("source",{srcset:"https://raw.githubusercontent.com/av1-community-contributors/codec-wiki/main/static/img/av1an_96_workers.avif",type:"image/avif"}),(0,r.jsx)("img",{src:"https://autumn.revolt.chat/attachments/K3OhOCAy9bkUCkImek_q3-t6q3zctbn9SbWW-_RI19/av1an_96_workers.webp",alt:"Av1an with 96 workers"})]}),"\n",(0,r.jsx)(n.p,{children:"Av1an is a video encoding framework. It can increase your encoding speed and improve CPU utilization by running multiple encoder processes in parallel. Target quality, VMAF plotting, and more, available to take advantage for video encoding."}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"Since Av1an is just a tool that helps with parallelization, you'll need to have the following installed for the entire thing to work:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Rust"}),"\n",(0,r.jsxs)(n.li,{children:["Python (Required for ",(0,r.jsx)(n.a,{href:"/docs/filtering/vapoursynth",children:"Vapoursynth"}),", currently needs 3.11, this may change in the future so consult from ",(0,r.jsx)(n.a,{href:"http://www.vapoursynth.com/doc/installation.html",children:"their website"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"FFmpeg"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/utilities/MKVToolNix",children:"MKVToolNix"})," (mkvmerge)"]}),"\n",(0,r.jsx)(n.li,{children:"Vapoursynth"}),"\n",(0,r.jsx)(n.li,{children:"L-SMASH (Vapoursynth plugin)"}),"\n",(0,r.jsx)(n.li,{children:"FFMS2 (Vapoursynth plugin, optional)"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/docs/metrics/VMAF",children:"VMAF"})," (For target VMAF, optional)"]}),"\n",(0,r.jsxs)(n.li,{children:["Any of the supported encoders (",(0,r.jsx)(n.a,{href:"/docs/encoders/aomenc",children:"aomenc"}),", ",(0,r.jsx)(n.a,{href:"/docs/encoders/rav1e",children:"rav1e"}),", ",(0,r.jsx)(n.a,{href:"/docs/encoders/SVT-AV1",children:"SVT-AV1"}),", ",(0,r.jsx)(n.a,{href:"/docs/encoders/vpxenc",children:"vpxenc"}),", ",(0,r.jsx)(n.a,{href:"/docs/encoders/x264",children:"x264"}),", ",(0,r.jsx)(n.a,{href:"/docs/encoders/x265",children:"x265"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsx)(n.h3,{id:"microsoft-windows",children:"Microsoft Windows"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"GUI:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Install ",(0,r.jsx)(n.a,{href:"/docs/utilities/nmkoder",children:"Nmkoder"})," which is a GUI front-end to av1an with all dependencies installed"]}),"\n",(0,r.jsx)(n.li,{children:"You're done!"}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Outdated Software",type:"danger",children:(0,r.jsxs)(n.p,{children:["Since Nmkoder already ships everything by default and it's last release was 29th March 2022. You need to manually update EVERYTHING (",(0,r.jsx)(n.code,{children:"av1an.exe"}),", ",(0,r.jsx)(n.code,{children:"aomenc.exe"}),", etc) to get performance optimizations, better speeds, and more settings. Missing out on updates will result in your encodes being sub-optimal."]})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Pre-built binary, bleeding edge [Recommended]:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Download Av1an from ",(0,r.jsx)(n.a,{href:"https://github.com/master-of-zen/Av1an/releases",children:"here"}),', select "Latest" and click the "Assets" dropdown. Put it in ',(0,r.jsx)(n.a,{href:"https://www.maketecheasier.com/what-is-the-windows-path",children:"PATH"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"macos",children:"MacOS"}),"\n",(0,r.jsx)(n.p,{children:"To be filled."}),"\n",(0,r.jsx)(n.h3,{id:"linux",children:"Linux"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"The Easy Way:"})}),"\n",(0,r.jsxs)(n.p,{children:["Install ",(0,r.jsx)(n.a,{href:"/docs/utilities/rAV1ator",children:"rAV1ator"}),", a GUI frontend for Av1an & the rust-based rav1e encoder."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Keep in mind Aviator only ships with ",(0,r.jsx)(n.strong,{children:"SVT-AV1"})," and rAV1ator with ",(0,r.jsx)(n.strong,{children:"rav1e"})," instead of Aomenc/AOM-AV1."]})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"The compiling route:"})}),"\n",(0,r.jsx)(n.p,{children:"Prerequisites:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Vapoursynth"}),"\n",(0,r.jsx)(n.li,{children:"FFmpeg"}),"\n",(0,r.jsx)(n.li,{children:"MKVToolNix (mkvmerge)"}),"\n",(0,r.jsx)(n.li,{children:"Git"}),"\n",(0,r.jsx)(n.li,{children:"Perl"}),"\n",(0,r.jsx)(n.li,{children:"Nasm"}),"\n",(0,r.jsx)(n.li,{children:"Rust (Use rustup on Debian/Ubuntu, as the package manager version is horribly outdated)"}),"\n",(0,r.jsx)(n.li,{children:"Highway (libhwy)"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'git clone https://github.com/master-of-zen/Av1an.git\ncd Av1an\nRUSTFLAGS="-C target-cpu=native" cargo build --release\n'})}),"\n",(0,r.jsxs)(n.p,{children:["after done, the binary will be located in ",(0,r.jsx)(n.code,{children:"target/release"}),", copy it to somewhere like ",(0,r.jsx)(n.code,{children:"/usr/bin"})," or ",(0,r.jsx)(n.code,{children:"/usr/local/bin"})]}),"\n",(0,r.jsx)(n.h3,{id:"docker",children:"Docker"}),"\n",(0,r.jsx)(n.p,{children:"The following examples assume the file you want to encode is in your current working directory."}),"\n",(0,r.jsxs)(s.A,{children:[(0,r.jsx)(a.A,{value:"windows",label:"Windows",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'docker run --privileged -v "$(pwd):/videos" --user $(id -u):$(id -g) -it --rm masterofzen/av1an:latest -i S01E01.mkv {options}\n'})})}),(0,r.jsx)(a.A,{value:"linux",label:"Linux",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'docker run --privileged -v "${PWD}:/videos" -it --rm masterofzen/av1an:latest -i S01E01.mkv {options}\n'})})}),(0,r.jsxs)(a.A,{value:"build",label:"Manual Build",children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'docker build -t "av1an" .\n'})}),(0,r.jsx)(n.p,{children:"Run in the root directory of the repository. The dependencies will automatically be installed into the image, no manual installations necessary."})]})]}),"\n",(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsx)(n.p,{children:"To specify a different directory to use you would replace $(pwd) with the directory"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'docker run --privileged -v "/c/Users/masterofzen/Videos":/videos --user $(id -u):$(id -g) -it --rm masterofzen/av1an:latest -i S01E01.mkv {options}\n'})}),(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"--user"})," flag is required on Linux to avoid permission issues with the docker container not being able to write to the location, if you get permission issues ensure your user has access to the folder that you are using to encode."]})]}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:['mkvmerge "Open file error" on Linux - Run ',(0,r.jsx)(n.code,{children:"ulimit -n 20000"})]}),"\n",(0,r.jsxs)(n.li,{children:["Gray screen flashing for a single frame in output - Create a lossless intermediary with x264 ",(0,r.jsx)(n.code,{children:"-qp 0"})]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},9365:(e,n,t)=>{t.d(n,{A:()=>a});t(6540);var r=t(8215);const i={tabItem:"tabItem_Ymn6"};var s=t(4848);function a(e){let{children:n,hidden:t,className:a}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(i.tabItem,a),hidden:t,children:n})}},1470:(e,n,t)=>{t.d(n,{A:()=>y});var r=t(6540),i=t(8215),s=t(3104),a=t(6347),l=t(205),o=t(7485),c=t(1682),d=t(9466);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:i}}=e;return{value:n,label:t,attributes:r,default:i}}))}(t);return function(e){const n=(0,c.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const i=(0,a.W6)(),s=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,o.aZ)(s),(0,r.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(i.location.search);n.set(s,e),i.replace({...i.location,search:n.toString()})}),[s,i])]}function x(e){const{defaultValue:n,queryString:t=!1,groupId:i}=e,s=h(e),[a,o]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:s}))),[c,u]=m({queryString:t,groupId:i}),[x,v]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[i,s]=(0,d.Dv)(t);return[i,(0,r.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:i}),f=(()=>{const e=c??x;return p({value:e,tabValues:s})?e:null})();(0,l.A)((()=>{f&&o(f)}),[f]);return{selectedValue:a,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),v(e)}),[u,v,s]),tabValues:s}}var v=t(2303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var g=t(4848);function b(e){let{className:n,block:t,selectedValue:r,selectValue:a,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),d=e=>{const n=e.currentTarget,t=o.indexOf(n),i=l[t].value;i!==r&&(c(n),a(i))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,g.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":t},n),children:l.map((e=>{let{value:n,label:t,attributes:s}=e;return(0,g.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>o.push(e),onKeyDown:u,onClick:d,...s,className:(0,i.A)("tabs__item",f.tabItem,s?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function j(e){let{lazy:n,children:t,selectedValue:i}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===i));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,g.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==i})))})}function w(e){const n=x(e);return(0,g.jsxs)("div",{className:(0,i.A)("tabs-container",f.tabList),children:[(0,g.jsx)(b,{...e,...n}),(0,g.jsx)(j,{...e,...n})]})}function y(e){const n=(0,v.A)();return(0,g.jsx)(w,{...e,children:u(e.children)},String(n))}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>l});var r=t(6540);const i={},s=r.createContext(i);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);